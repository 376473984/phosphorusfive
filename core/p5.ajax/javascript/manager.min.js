(function(){window.p5={};window.p5.extend=function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n};window.p5.$=function(n){return n instanceof HTMLElement?new window.p5.el(n):new window.p5.el(document.getElementById(n))};window.p5.e=function(n){var t=window.p5.$(n.currentTarget);t.raise("on"+n.type);n.preventDefault();n.stopPropagation()};window.p5._getChange=function(n,t){if(t!==null){n!=null&&n.indexOf!=null&&n.indexOf("\r")==-1&&(n=n.replace("\n","\r\n"));var i=function(n){var t=document.createElement("textarea");return t.innerHTML=n,t.value};if(typeof t=="object")return t.length===2?n.substring(0,t[0])+i(t[1]):typeof t[0]=="number"?n.substring(0,t[0]):n+i(t[0])}return t};window.p5.el=function(n){this.el=n};window.p5.el.prototype={_getAncestor:function(n){for(var t=this.el;t.tagName.toLowerCase()!==n;)t=t.parentNode;return window.p5.$(t)},Tag:function(n){var r=this.el.outerHTML,t="<"+n+r.substring(this.el.tagName.length+1),i;t=t.substring(0,t.length-(this.el.tagName.length+1));t+=n+">";i=this.el.id;this.el.outerHTML=t;this.el=window.p5.$(i).el},outerHTML:function(n){var t=this.el.id;this.el.outerHTML=window.p5._getChange(this.el.outerHTML,n);this.el=window.p5.$(t).el},innerValue:function(n){this.el.tagName==="TEXTAREA"?this.el.value=window.p5._getChange(this.el.value,n):this.el.innerHTML=window.p5._getChange(this.el.innerHTML,n)},"class":function(n){this.el.className=window.p5._getChange(this.el.className,n)},value:function(n){var r,i,t;if(this.el.tagName.toLowerCase()=="select"){for(n=window.p5._getChange(function(){for(var t="",n=0;n<this.el.children.length;n++)this.el.children[n].selected&&(t+=this.el.children[n].value+",");return t.substring(0,t.length-2)}.apply(this),n),t=0;t<this.el.children.length;t++)this.el.children[t].selected=!1;for(r=n.split(","),i=0;i<r.length;i++)for(t=0;t<this.el.children.length;t++)(r[i]==this.el.children[t].value||r[i]==this.el.children[t].innerHTML)&&(this.el.children[t].selected=!0)}else this.el.value=window.p5._getChange(this.el.value,n)},style:function(n){this.el.style.cssText=n},_p5_del:function(n){for(var i,t=0;t<n.length;t++)i=n[t],this["_p5_del_"+i]?this["_p5_del_"+i]():this.el.removeAttribute(i)},_p5_del_innerValue:function(){this.el.tagName==="TEXTAREA"?this.el.value="":this.el.innerHTML=""},_p5_del_checked:function(){this.el.checked=!1},_p5_del_class:function(){this.el.className=""},_p5_del_value:function(){this.el.value=""},_p5_del_style:function(){this.el.style.cssText=""},_set:function(n,t){if(this[n])this[n](t);else if(n.indexOf("__p5_add_")!==-1){var u=parseInt(n.substring(9),10),i=document.createDocumentFragment(),r=document.createElement(this.el.tagName);r.innerHTML=t;i.appendChild(r.firstChild);this.el.insertBefore(i,this.el.children[u])}else t===null?this.el[n]=!0:this.el.setAttribute(n,window.p5._getChange(this.el[n],t))},serialize:function(){for(var n,i,r,t=[],f=this.el.getElementsByTagName("*"),u=0;u<f.length;u++)if(n=f[u],!n.disabled&&n.name)switch(n.tagName.toLowerCase()){case"input":switch(n.type){case"submit":break;case"checkbox":case"radio":n.checked&&t.push([n.name,n.value]);break;default:t.push([n.name,n.value])}break;case"textarea":i=n.value;i.indexOf("\r")==-1&&(i=i.replace("\n","\r\n"));t.push([n.name,i]);break;case"select":for(r=0;r<n.options.length;r++)n.options[r].selected&&t.push([n.name,encodeURIComponent(n.options[r].value)])}return t},_raise:function(n,t){var o=this._getAncestor("form"),i=new XMLHttpRequest,s,r,u,f,e;for(i.open("POST",o.el.action,!0),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s=this,i.onreadystatechange=function(){i.readyState===4&&s._done(i)},r=o.serialize(),t.onbefore.apply(this,[r,n]),u="_p5_event="+n+"&_p5_widget="+this.el.id,f=0;f<r.length;f++)u+="&",e=r[f],u+=e[0]+"="+encodeURIComponent(e[1]);i.send(u)},raise:function(n,t){return t=window.p5.extend({onbefore:function(){},onsuccess:function(){},onerror:this.onerror},t),window.p5._chain.push({evt:n,el:this,options:t}),window.p5._chain.length===1&&window.p5._next(),this},onerror:function(n,t,i){var u=document.createElement("div"),r,f;u.id="__p5_error";u.className="p5-exception";r=document.createElement("button");r.innerHTML="Close";r.onclick=function(){var n=window.p5.$("__p5_error").el;n.parentNode.removeChild(n)};r.onkeyup=function(n){if(n.keyCode===27){var t=window.p5.$("__p5_error").el;t.parentNode.removeChild(t)}};u.innerHTML=i;u.appendChild(r);f=document.getElementsByTagName("body")[0];f.appendChild(u);r.focus()},_done:function(n){var h=window.p5._chain[0],c=h.options,r,t,i,u,f,e,o,s,l,a,v;if(n.status>=200&&n.status<300){for(r=eval("("+n.responseText+")"),c.onsuccess.apply(this,[r,h.evt]),t=r._p5_del||[],u=0;u<t.length;u++)i=window.p5.$(t[u]).el,i.parentNode.removeChild(i);t=r.__p5_change||{};for(f in t)if(t.hasOwnProperty(f)){i=window.p5.$(f);e=t[f];for(o in e)e.hasOwnProperty(o)&&i._set(o,e[o])}for(t=r._p5_css_files||[],s=0;s<t.length;s++)i=document.createElement("link"),l=t[s],i.href=l,i.rel="stylesheet",i.type="text/css",a=document.getElementsByTagName("head")[0],a.appendChild(i);this._includeScripts(r._p5_js_objects||[],r._p5_script||[]);window.p5._chain.splice(0,1)}else v=c.onerror.apply(this,[n.status,n.statusText,n.responseText,h.evt]),v===!0?window.p5._chain.splice(0,1):window.p5._chain=[];window.p5._next()},_includeScripts:function(n,t){var u,i,r;if(n.length>0)u=this,n[0].Item2===!0?(i=new XMLHttpRequest,i.open("GET",n[0].Item1,!0),i.onload=function(){if(i.readyState===4)if(i.status===200)eval(i.responseText),n.splice(0,1),u._includeScripts(n,t);else throw"Couldn't download JavaScript file; '"+n[0].Item1+"'";},i.onerror=function(){throw"Couldn't download JavaScript file; '"+n[0].Item1+"'";},i.send(null)):(eval(n[0].Item1),n.splice(0,1),this._includeScripts(n,t));else for(r=0;r<t.length;r++)eval(t[r])}};window.p5._chain=[];window.p5._next=function(){if(window.p5._chain.length>0){var n=window.p5._chain[0],t=window.p5.$(n.el.el.id);t.el?t._raise(n.evt,n.options):(window.p5._chain.splice(0,1)[0],window.p5._next())}}})();