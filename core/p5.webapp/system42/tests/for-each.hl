/*
 * Contains [for-each] unit tests in system
 */

/*
 * Tests a simple value type of [for-each]
 */
value
  _data
    foo1:bar1
    foo2:bar2
  for-each:x:/../*/_data/*?value
    set:x:/./-?value
      src:{0}{1}
        :x:/../0?value
        :x:/..for-each/*/_dp?value
  if:x:/../0?value
    !=:bar1bar2
    throw:@"Assert error, expected [bar1bar2], got [{0}]!"
      :x:/../0?value

/*
 * Tests a simple name type of [for-each]
 */
name
  _data
    foo1:bar1
    foo2:bar2
  for-each:x:/../*/_data/*?name
    set:x:/./-?value
      src:{0}{1}
        :x:/../0?value
        :x:/..for-each/*/_dp?value
  if:x:/../0?value
    !=:foo1foo2
    throw:@"Assert error, expected [foo1foo2], got [{0}]!"
      :x:/../0?value

/*
 * Tests a simple node type of [for-each]
 */
node
  _data
    foo1:bar1
    foo2:bar2
  for-each:x:/../*/_data/*
    set:x:/./-?value
      src:{0}{1}
        :x:/../0?value
        :x:/..for-each/*/_dp/#?node.string
  if:x:/../0?value
    !=:@"foo1:bar1foo2:bar2"
    throw:@"Assert error, expected [foo1:bar1foo2:bar2], got [{0}]!"
      :x:/../0?value
