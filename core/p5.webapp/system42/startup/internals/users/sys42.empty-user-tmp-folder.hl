
/*
 * Empties the currently logged in user's "tmp" folder, invoked when
 * user is logging out of system
 */

create-protected-event:sys42.empty-user-tmp-folder

  // Retrieving user
  whoami
  if:x:/-/*/default?value
    not

    // User is not default user, deleting all files in user's tmp folder
    list-files:/users/{0}/tmp/
      :x:/../*/whoami/*/username?value
    delete-file:x:/-/*?name

    // Then deleting all folders in user tmp folder
    list-folders:/users/{0}/tmp/
      :x:/../*/whoami/*/username?value
    delete-folder:x:/-/*?name

