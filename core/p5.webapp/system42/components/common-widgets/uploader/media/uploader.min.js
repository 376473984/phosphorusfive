(function(){window.p5.uploader=function(n,t,i,r){this._widget=p5.$(n);this._cssClass=t;this._hoverClass=i;this._dropClass=r;var u=this;this._widget.el.addEventListener("dragover",function(n){n.preventDefault();u._widget.el.className=u._cssClass+" "+u._hoverClass},!1);this._widget.el.addEventListener("dragleave",function(n){n.preventDefault();u._widget.el.className=u._cssClass},!1);this._widget.el.addEventListener("drop",function(n){if(n.preventDefault(),n.dataTransfer.files.length>0){u._widget.el.className=u._cssClass+" "+u._dropClass;u._files=[];for(var t=0;t<n.dataTransfer.files.length;t++)u._files.push(n.dataTransfer.files[t]);u._count=u._files.length;u.processNext(1)}},!1)};window.p5.uploader.prototype.processNext=function(n){var i=this._files.splice(0,1)[0],r=new FileReader,t=this;r.onload=function(r){t._widget.raise("_onupload",{onsuccess:function(){t._files.length>0?t.processNext(++n):t._widget.el.className=t._cssClass},onbefore:function(u){u.push(["sys42.widgets.uploader.count",t._count]);u.push(["sys42.widgets.uploader.current",n]);u.push(["sys42.widgets.uploader.filename",i.name]);u.push(["sys42.widgets.uploader.content",btoa(r.target.result)])}})};r.readAsBinaryString(i)}})();