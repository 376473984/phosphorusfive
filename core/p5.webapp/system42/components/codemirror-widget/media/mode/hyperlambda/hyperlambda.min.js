(function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})(function(n){"use strict";n.defineMode("hyperlambda",function(){return{styles:{comment:"comment",string:"string",value:"property",keyword:"keyword",variable:"variable",activeevent:"variable-2",type:"def",expression:"number",widget_property:"tag widget-property",widget_attribute:"tag widget-attribute",widget_type:"tag widget-type",error:"error"},indent:function(n){return n.indent},startState:function(){return{mode:"name",indent:0,previousIndent:0,noContent:!0}},token:function(n,t){switch(t.mode){case"name":return this.tokenizeNameMode(n,t);case"value":return this.tokenizeValueMode(n,t);case"mcomment":return this.tokenizeMultiCommentMode(n,t);case"mstring-name":return this.tokenizeMultilineStringMode(n,t,!0);case"mstring-value":return this.tokenizeMultilineStringMode(n,t,!1);case"error":return n.skipToEnd(),this.styles.error}},tokenizeNameMode:function(n,t){for(var r=0,f,i,u;n.peek()==" ";)r+=1,n.next();f=null;i=n.peek();switch(i){case'"':return(t.noContent=!1,n.next(),this.checkIndentation(t,r)===!0)?this.styles.error:this.parseSingleLineStringLiteral(n,t);case"@":if(this.checkIndentation(t,r)===!0)return this.styles.error;if(t.noContent=!1,n.next(),i+=n.next(),i=='@"')return t.mode="mstring-name",t.oldIndent=t.indent,t.indent=0,this.tokenizeMultilineStringMode(n,t,!0);break;case":":return this.checkIndentation(t,r)===!0?this.styles.error:(t.noContent=!1,t.mode="value",this.styles.type);case"/":if(n.next(),n.peek()=="/")return this.parseSingleLineComment(n,t);if(n.peek()=="*")return t.mode="mcomment",this.tokenizeMultiCommentMode(n,t)}if(n.next(),i!=null&&this.checkIndentation(t,r)===!0)return this.styles.error;for(u=i;;){if(i=n.peek(),i==null){n.next();break}else if(i==":")break;else n.next();u+=i}return i==":"&&(t.mode="value",f=this.styles.type),t.noContent=!1,u!=null&&u.length>0&&(f=this.getNodeNameType(u,t)),f},tokenizeValueMode:function(n,t){if(this.is_ex===!0)return t.mode="name",this.is_ex=!1,this.parseLambdaExpression(n,t);var i=n.next(),r=this.styles.value;switch(i){case'"':return t.mode="name",this.parseSingleLineStringLiteral(n,t);case"@":if(i=n.peek(),i=='"')n.next(),t.mode="mstring-value",t.oldIndent=t.indent,t.indent=0,r=this.tokenizeMultilineStringMode(n,t,!1);else for(t.mode="name";n.next()!=null;);break;case":":r=this.styles.type;n.peek()==null&&(t.mode="name");break;default:for(;;)if(i=n.next(),i==null){t.mode="name";break}else if(i==":"){if(n.peek()==null){t.mode="name";break}n.string.substring(n.start,n.pos-1)=="x"&&(this.is_ex=!0);r=this.styles.type;break}}return r},tokenizeMultiCommentMode:function(n,t){n.skipToEnd();var i=n.current();if(i.indexOf("*/",i.length-2)!=-1)t.mode="name";else if(i.indexOf("*/")!=-1)return t.mode="error",this.styles.error;return this.styles.comment},tokenizeMultilineStringMode:function(n,t,i){for(var r=n.next(),u=!1,f;r!=null;)if(r=='"'&&n.peek()!='"'){u=!0;break}else if(r=='"'){for(f=r;r=='"';)r=n.peek(),r=='"'&&(f+=r,n.next());if(f.length%2==1){u=!0;break}}else r=n.next();if(u){if(t.indent=t.oldIndent,r=n.peek(),!i&&r!=null)return t.mode="error",this.styles.error;if(r==null)t.mode="name";else if(r==":")t.mode="value";else return t.mode="error",this.styles.error}return this.styles.string},parseSingleLineStringLiteral:function(n,t){for(var i=n.next(),r="";;){if(i=='"'&&r!="\\"){if(n.eatSpace(),n.peek()!=null&&n.peek()!=":")return t.mode="error",n.skipToEnd(),this.styles.error;break}if(i==null)return t.mode="error",this.styles.error;r=i;i=n.next()}return this.styles.string},parseLambdaExpression:function(n){return n.skipToEnd(),this.styles.expression},parseSingleLineComment:function(n){return n.skipToEnd(),this.styles.comment},checkIndentation:function(n,t){return t%2!=0?(n.mode="error",!0):t-n.previousIndent>2||t==2&&n.noContent===!0?(n.mode="error",!0):(n.indent=t,n.previousIndent=t,!1)},getNodeNameType:function(n,t){switch(n){case"and":case"or":case"xor":case"can-convert":case"eval":case"if":case"else-if":case"else":case"set":case"add":case"retrieve":case"fetch":case"while":case"for-each":case"insert-before":case"insert-after":case"lock":case"fork":case"wait":case"split":case"join":case"to-upper":case"to-lower":case"+":case"-":case"/":case"*":case"%":case"^":case"lambda2hyper":case"lambda2csv":case"lambda2xml":case"html2xml":case"create-event":case"create-event":case"login":case"create-user":case"eval-mutable":case"move-file":case"copy-file":case"move-folder":case"copy-folder":case"save-file":case"list-files":case"update-data":case"insert-data":case"append-data":case"set-context-value":case"set-session-value":case"set-global-value":case"set-http-header":case"set-widget-property":case"set-cache-value":case"set-cookie-value":case"set-widget-ajax-event":case"set-widget-lambda-event":case"return-response-object":case"raise-widget-ajax-event":case"get-widget-property":case"zip":case"unzip":case"set-page-value":case"format-date":case"edit-user":case"match":case"index-of":case"replace":case"try":case"catch":case"finally":case"apply":case"template":case"sort":case"switch":case"case":case"default":case"find-widget":case"find-widget-like":case"find-first-ancestor-widget":case"find-first-ancestor-widget-like":case"find-first-descendant-widget":case"return":return t.indent+=2,this.styles.keyword;case"not":case"src":case"sleep":case"=":case"!=":case">":case"<":case">=":case"<=":case"~":case"!~":case"hyper2lambda":case"csv2lambda":case"xml2lambda":case"html2lambda":case"sha256-hash":case"widget-exist":case"reload-location":case"whoami":case"logout":case"list-roles":case"sleep":case"clear-widget":case"delete-widget":case"get-parent-widget":case"get-children-widgets":case"list-widgets":case"get-widget-ajax-event":case"get-widget-lambda-event":case"list-widget-ajax-events":case"list-widget-lambda-events":case"include-javascript":case"send-javascript":case"include-javascript-file":case"include-stylesheet-file":case"set-title":case"get-title":case"set-location":case"get-location":case"get-base-location":case"file-exist":case"load-file":case"load-text-file":case"load-binary-file":case"delete-file":case"create-folder":case"folder-exist":case"list-folders":case"delete-folder":case"select-data":case"delete-data":case"get-context-value":case"get-session-value":case"list-context-keys":case"list-session-keys":case"get-application":case"list-global-keys":case"echo":case"echo-file":case"echo-mime":case"delete-widget-property":case"list-widget-properties":case"list-page-keys":case"get-page-value":case"get-cache-value":case"list-cache-keys":case"get-cookie-value":case"list-cookie-keys":case"get-http-header":case"list-http-headers":case"get-http-param":case"list-http-params":case"get-http-method":case"get-request-body":case"delete-event":case"vocabulary":case"set-http-status":case"set-http-status-code":case"date-now":case"create-cs-random":case"list-users":case"get-user":case"delete-user":case"abs":case"acos":case"asin":case"atan":case"ceiling":case"floor":case"cos":case"cosh":case"log":case"log10":case"round":case"sin":case"sinh":case"sqrt":case"tan":case"tanh":case"length":case"throw":case"eval-x":case"new-guid":case"break":case"continue":case"url-encode":case"url-decode":case"html-encode":case"html-decode":case"request-is-mobile-device":case"what":return this.styles.keyword;case"create-widget":case"create-container-widget":case"create-literal-widget":case"create-void-widget":case"literal":case"void":case"container":case"address":case"article":case"aside":case"footer":case"header":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"nav":case"section":case"blockquote":case"dd":case"div":case"dl":case"dt":case"figcaption":case"figure":case"li":case"main":case"ol":case"p":case"pre":case"ul":case"abbr":case"b":case"bdi":case"bdo":case"cite":case"code":case"data":case"dfn":case"em":case"i":case"kbd":case"mark":case"q":case"rp":case"rt":case"rtc":case"ruby":case"s":case"samp":case"small":case"span":case"strong":case"sub":case"sup":case"svg":case"time":case"u":case"var":case"wbr":case"a":case"math":case"iframe":case"area":case"audio":case"map":case"track":case"video":case"source":case"img":case"canvas":case"del":case"ins":case"caption":case"col":case"colgroup":case"table":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":case"button":case"datalist":case"fieldset":case"input":case"textarea":case"keygen":case"label":case"legend":case"meter":case"optgroup":case"option":case"output":case"progress":case"select":case"details":case"dialog":case"menu":case"menuitem":case"summary":case"content":case"shadow":case"template":return t.indent+=2,this.styles.widget_type;case"text":case"hr":case"br":return this.styles.widget_type;case"widgets":case"events":return t.indent+=2,this.styles.widget_property;case"innerValue":case"parent":case"before":case"after":case"position":case"element":case"visible":case"render-type":return this.styles.widget_property;case"accesskey":case"class":case"contenteditable":case"contextmenu":case"dir":case"hidden":case"lang":case"style":case"tabindex":case"title":case"value":case"href":return this.styles.widget_attribute;case"onclick":case"ondblclick":case"onmouseover":case"onmouseout":case"onchange":case"oncontextmenu":case"onmouseenter":case"onmousedown":case"onmouseleave":case"onmousemove":case"onmouseover":case"onmouseup":case"onkeydown":case"onkeypress":case"onkeyup":case"onblur":case"onfocus":case"onfocusin":case"onfocusout":case"oninput":case"oninvalid":case"onsearch":case"onselect":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondragstart":case"ondrop":case"oncopy":case"oncut":case"onpaste":case"onabort":case"oncanplay":case"oncanplaythrough":case"ondurationchange":case"onemptied":case"onended":case"onerror":case"onloadeddata":case"onloadedmetadata":case"onloadstart":case"onpause":case"onplay":case"onplaying":case"onprogress":case"onratechange":case"onseeked":case"onseeking":case"onstalled":case"onsuspend":case"ontimeupdate":case"onvolumechange":case"onwaiting":case"ontouchcancel":case"ontouchend":case"ontouchmove":case"ontouchstart":case"oninit":return t.indent+=2,this.styles.widget_attribute;default:if(n[0]=="_")return this.styles.variable;if(n.indexOf(".")!=-1)return t.indent+=2,this.styles.activeevent;if(n.indexOf("data-")==0)return t.indent+=2,this.styles.widget_attribute}}}});n.defineMIME("text/x-hyperlambda","hyperlambda");n.registerHelper("hint","hyperlambda",function(t){var i;if(n._hyperlispKeywords!=null){var r=t.getCursor(),u=r.ch,f=[],o=t.getLine(r.line),e=o.trim(),s=u-e.length;for(i=0;i<n._hyperlispKeywords.length;i++)n._hyperlispKeywords[i].indexOf(e)!=-1&&f.push(n._hyperlispKeywords[i]);return{list:f,from:n.Pos(r.line,s),to:n.Pos(r.line,u)}}})});